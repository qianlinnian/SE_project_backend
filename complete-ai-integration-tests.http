### ğŸš€ å®Œæ•´çš„å¤šæ–¹å‘è§†é¢‘åˆ†æAIé›†æˆæµ‹è¯•ç”¨ä¾‹
### è§£å†³å››æ­¥å¯¹æ¥ä¸­çš„æ‰€æœ‰é—®é¢˜ï¼šè§†é¢‘ä¸Šä¼  â†’ AIåˆ†æ â†’ ç»“æœå›è°ƒ â†’ è¿ç« éªŒè¯

### ===== 1. æ­¥éª¤1ï¼šç”¨æˆ· â†’ æ‚¨çš„åç«¯ï¼ˆè§†é¢‘ä¸Šä¼ ï¼‰ =====

### 1.1 å•ä¸ªæ–¹å‘è§†é¢‘ä¸Šä¼ åˆ†æï¼ˆæ–°ç‰ˆæ¨èæ¥å£ï¼‰
POST http://localhost:8088/api/violation-detection/upload-video-for-analysis
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="video"; filename="south_red_light_violation.mp4"
Content-Type: video/mp4

< ./test_videos/south_red_light_violation.mp4
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="intersectionId"

1
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="direction"

SOUTH
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### 1.2 æ‰¹é‡å¤šæ–¹å‘è§†é¢‘ä¸Šä¼ 
POST http://localhost:8088/api/violation-detection/upload-multi-direction-videos
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="intersectionId"

1
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="eastVideo"; filename="east_illegal_turn.mp4"
Content-Type: video/mp4

< ./test_videos/east_illegal_turn.mp4
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="southVideo"; filename="south_wrong_way.mp4"
Content-Type: video/mp4

< ./test_videos/south_wrong_way.mp4
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="westVideo"; filename="west_cross_line.mp4"
Content-Type: video/mp4

< ./test_videos/west_cross_line.mp4
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### ===== 2. æ­¥éª¤2ï¼šAIæ¨¡å‹æ¥æ”¶ï¼ˆAIåŒå­¦éœ€è¦å®ç°çš„æ¥å£ï¼‰ =====

### 2.1 AIæ¨¡å‹æ¥æ”¶åˆ†æè¯·æ±‚çš„ç¤ºä¾‹æ ¼å¼
# AIåŒå­¦éœ€è¦å®ç°æ­¤æ¥å£æ¥æ”¶æ‚¨çš„åˆ†æè¯·æ±‚
# POST http://localhost:5000/analyze-video
# {
#   "taskId": "550e8400-e29b-41d4-a716-446655440000",
#   "videoUrl": "http://localhost:8088/api/files/video/intersection_1/video_20241219_143022.mp4",
#   "intersectionId": 1,
#   "direction": "SOUTH",
#   "callbackUrl": "http://localhost:8088/api/violation-detection/ai-callback",
#   "requestTime": "2024-12-19T14:30:22"
# }

### ===== 3. æ­¥éª¤3ï¼šAI â†’ æ‚¨çš„åç«¯ï¼ˆç»“æœå›è°ƒï¼‰ =====

### 3.1 AIå•ä¸ªè¿ç« ç»“æœå›è°ƒï¼ˆAIåŒå­¦è°ƒç”¨æ‚¨çš„æ¥å£ï¼‰
POST http://localhost:8088/api/violation-detection/ai-callback
Content-Type: application/json

{
  "taskId": "550e8400-e29b-41d4-a716-446655440000",
  "plateNumber": "æ²ªA12345",
  "violationType": "é—¯çº¢ç¯",
  "confidence": 0.95,
  "turnType": "STRAIGHT",
  "frameTimestamp": 15.2,
  "boundingBox": {
    "x": 100,
    "y": 150,
    "width": 200,
    "height": 120
  },
  "imageUrl": "http://minio:9000/violations/violation_frame_15_2.jpg"
}

### 3.2 AIæ‰¹é‡è¿ç« ç»“æœå›è°ƒ
POST http://localhost:8088/api/violation-detection/ai-callback
Content-Type: application/json

{
  "taskId": "550e8400-e29b-41d4-a716-446655440001",
  "results": [
    {
      "plateNumber": "äº¬B66666",
      "violationType": "è¿æ³•è½¬å¼¯",
      "confidence": 0.88,
      "turnType": "LEFT_TURN",
      "frameTimestamp": 25.5,
      "boundingBox": {"x": 150, "y": 200, "width": 180, "height": 100}
    },
    {
      "plateNumber": "ç²¤C88888", 
      "violationType": "é€†è¡Œ",
      "confidence": 0.92,
      "turnType": "STRAIGHT",
      "frameTimestamp": 45.8,
      "boundingBox": {"x": 300, "y": 250, "width": 220, "height": 130}
    }
  ]
}

### 3.3 AIåˆ†æå®Œæˆé€šçŸ¥
POST http://localhost:8088/api/violation-detection/ai-completed
Content-Type: application/json

{
  "taskId": "550e8400-e29b-41d4-a716-446655440000",
  "totalDetections": 3,
  "processingTime": "00:02:45",
  "status": "completed"
}

### ===== 4. æ­¥éª¤4ï¼šä»»åŠ¡çŠ¶æ€æŸ¥è¯¢å’Œç®¡ç† =====

### 4.1 æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€å’Œè¿›åº¦
GET http://localhost:8088/api/violation-detection/task/550e8400-e29b-41d4-a716-446655440000/status

### 4.2 æŸ¥è¯¢è·¯å£æ‰€æœ‰ä»»åŠ¡
GET http://localhost:8088/api/violation-detection/intersection/1/tasks?page=0&size=10

### 4.3 è·å–ä»»åŠ¡ç»Ÿè®¡ä¿¡æ¯
GET http://localhost:8088/api/violation-detection/tasks/statistics

### 4.4 è·å–AIæœåŠ¡çŠ¶æ€
GET http://localhost:8088/api/ai-integration/status

### ===== 5. å¤šæ–¹å‘ä¿¡å·ç¯çŠ¶æ€éªŒè¯ =====

### 5.1 éªŒè¯å—å‘å·¦è½¬ä¿¡å·ç¯çŠ¶æ€
GET http://localhost:8088/api/multi-direction-traffic/intersections/1/directions/SOUTH/turns/LEFT_TURN/status

### 5.2 æŸ¥çœ‹æ‰€æœ‰æ–¹å‘å½“å‰çŠ¶æ€  
GET http://localhost:8088/api/multi-direction-traffic/intersections/1/status

### 5.3 æ¨¡æ‹Ÿè®¾ç½®ä¿¡å·ç¯çŠ¶æ€ï¼ˆæµ‹è¯•ç”¨ï¼‰
POST http://localhost:8088/api/multi-direction-traffic/intersections/1/simulate
Content-Type: application/json

{
  "direction": "SOUTH",
  "turnType": "LEFT_TURN", 
  "lightPhase": "RED",
  "duration": 30
}

### ===== 6. WebSocketå®æ—¶é€šçŸ¥æµ‹è¯• =====

### 6.1 WebSocketè¿æ¥åœ°å€
# ws://localhost:8088/ws-notifications

### 6.2 è®¢é˜…ç‰¹å®šä»»åŠ¡é€šçŸ¥
# /topic/task/550e8400-e29b-41d4-a716-446655440000

### 6.3 è®¢é˜…æ‰€æœ‰ä»»åŠ¡é€šçŸ¥
# /topic/tasks

### 6.4 è®¢é˜…ç³»ç»Ÿé€šçŸ¥
# /topic/system

### ===== 7. å…¼å®¹æ€§æµ‹è¯•ï¼ˆåŸæœ‰æ¥å£ï¼‰ =====

### 7.1 åŸæœ‰çš„å¸§æ£€æµ‹æ¥å£ï¼ˆç°åœ¨æ”¯æŒæ–¹å‘å‚æ•°ï¼‰
POST http://localhost:8088/api/violation-detection/detect-frame
Content-Type: application/json

{
  "intersectionId": 1,
  "direction": "SOUTH",
  "turnType": "LEFT_TURN",
  "plateNumber": "æ²ªA12345",
  "violationType": "é—¯çº¢ç¯",
  "imageUrl": "http://minio:9000/test.jpg", 
  "confidence": 0.95
}

### 7.2 æ–¹å‘ç‰¹å®šæ£€æµ‹æ¥å£
POST http://localhost:8088/api/violation-detection/directions/SOUTH/detect-frame
Content-Type: application/json

{
  "intersectionId": 1,
  "plateNumber": "äº¬B77777",
  "violationType": "è¿æ³•è½¬å¼¯",
  "confidence": 0.89
}

### ===== 8. ç³»ç»Ÿç®¡ç†å’Œç›‘æ§ =====

### 8.1 è·å–WebSocketé€šçŸ¥æœåŠ¡çŠ¶æ€
GET http://localhost:8088/api/system/notification-service/status

### 8.2 è·å–ä»»åŠ¡è°ƒåº¦æœåŠ¡çŠ¶æ€
GET http://localhost:8088/api/system/schedule-service/status

### 8.3 æ‰‹åŠ¨è§¦å‘è¶…æ—¶ä»»åŠ¡å¤„ç†ï¼ˆç®¡ç†å‘˜åŠŸèƒ½ï¼‰
POST http://localhost:8088/api/system/schedule-service/handle-timeout-tasks

### 8.4 æ‰‹åŠ¨è§¦å‘å¤±è´¥ä»»åŠ¡é‡è¯•ï¼ˆç®¡ç†å‘˜åŠŸèƒ½ï¼‰
POST http://localhost:8088/api/system/schedule-service/retry-failed-tasks

### ===== 9. é”™è¯¯å¤„ç†æµ‹è¯• =====

### 9.1 æµ‹è¯•æ— æ•ˆæ–¹å‘å‚æ•°
POST http://localhost:8088/api/violation-detection/upload-video-for-analysis
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="video"; filename="test.mp4"
Content-Type: video/mp4

< ./test.mp4
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="intersectionId"

1
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="direction"

INVALID_DIRECTION
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### 9.2 æµ‹è¯•AIå›è°ƒé”™è¯¯ä»»åŠ¡ID
POST http://localhost:8088/api/violation-detection/ai-callback
Content-Type: application/json

{
  "taskId": "non-existent-task-id",
  "plateNumber": "æµ‹è¯•A123",
  "violationType": "é—¯çº¢ç¯",
  "confidence": 0.95
}

### ===== 10. æ€§èƒ½å’Œå‹åŠ›æµ‹è¯• =====

### 10.1 æ‰¹é‡åˆ›å»ºä»»åŠ¡ï¼ˆå‹åŠ›æµ‹è¯•ï¼‰
POST http://localhost:8088/api/violation-detection/upload-multi-direction-videos
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="intersectionId"

2
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="eastVideo"; filename="pressure_test_1.mp4"
Content-Type: video/mp4

< ./pressure_test_1.mp4
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="southVideo"; filename="pressure_test_2.mp4"  
Content-Type: video/mp4

< ./pressure_test_2.mp4
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="westVideo"; filename="pressure_test_3.mp4"
Content-Type: video/mp4

< ./pressure_test_3.mp4
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="northVideo"; filename="pressure_test_4.mp4"
Content-Type: video/mp4

< ./pressure_test_4.mp4
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### ===== ä½¿ç”¨è¯´æ˜ =====
#
# ğŸ¯ å®Œæ•´çš„å››æ­¥å¯¹æ¥æµç¨‹å·²å®ç°ï¼š
#
# æ­¥éª¤1ï¼šç”¨æˆ·ä¸Šä¼ è§†é¢‘ â†’ æ‚¨çš„åç«¯
# - æ”¯æŒå•ä¸ªæ–¹å‘å’Œæ‰¹é‡å¤šæ–¹å‘ä¸Šä¼ 
# - è‡ªåŠ¨ç”Ÿæˆä»»åŠ¡IDå’Œåˆ›å»ºä»»åŠ¡è®°å½•
# - æ”¯æŒæ–‡ä»¶éªŒè¯å’Œæ–¹å‘å‚æ•°éªŒè¯
# - ç«‹å³è¿”å›ä»»åŠ¡ä¿¡æ¯ç»™ç”¨æˆ·
#
# æ­¥éª¤2ï¼šæ‚¨çš„åç«¯ â†’ AIæ¨¡å‹
# - å¼‚æ­¥è°ƒç”¨AIæ¨¡å‹åˆ†ææ¥å£
# - æ”¯æŒé‡è¯•å’Œè¶…æ—¶å¤„ç†
# - è‡ªåŠ¨æ„å»ºæ ‡å‡†åŒ–çš„AIè¯·æ±‚æ ¼å¼
# - æä¾›å›è°ƒURLç»™AIæ¨¡å‹
#
# æ­¥éª¤3ï¼šAIæ¨¡å‹ â†’ æ‚¨çš„åç«¯  
# - æ¥æ”¶AIå•ä¸ªæˆ–æ‰¹é‡æ£€æµ‹ç»“æœ
# - è‡ªåŠ¨å…³è”ä»»åŠ¡IDå’Œæ–¹å‘ä¿¡æ¯
# - æ”¯æŒå»é‡å’Œæ•°æ®éªŒè¯
# - ä¿å­˜AIåŸå§‹ç»“æœç”¨äºå®¡è®¡
#
# æ­¥éª¤4ï¼šæ‚¨çš„åç«¯å¤„ç†
# - ç»“åˆå¤šæ–¹å‘ä¿¡å·ç¯çŠ¶æ€éªŒè¯è¿ç« 
# - è‡ªåŠ¨è¿‡æ»¤ä¸æ„æˆè¿ç« çš„æ£€æµ‹ç»“æœ
# - å®æ—¶æ›´æ–°ä»»åŠ¡çŠ¶æ€å’Œè¿›åº¦
# - WebSocketæ¨é€é€šçŸ¥ç»™å‰ç«¯
#
# ğŸš€ è§£å†³çš„å…³é”®é—®é¢˜ï¼š
# âœ… ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šä»ä¸Šä¼ åˆ°å®Œæˆçš„å…¨ç¨‹è·Ÿè¸ª
# âœ… AIé›†æˆå’Œé‡è¯•ï¼šç¨³å®šçš„AIæ¨¡å‹è°ƒç”¨å’Œé”™è¯¯å¤„ç†
# âœ… å¼‚æ­¥å¤„ç†ï¼šç”¨æˆ·ä¸Šä¼ åç«‹å³å“åº”ï¼Œåå°å¼‚æ­¥å¤„ç†
# âœ… å®æ—¶é€šçŸ¥ï¼šWebSocketæ¨é€ä»»åŠ¡çŠ¶æ€ç»™å‰ç«¯
# âœ… å¤šæ–¹å‘æ”¯æŒï¼šæ”¯æŒå››ä¸ªæ–¹å‘ç‹¬ç«‹çš„è§†é¢‘åˆ†æ
# âœ… ä¿¡å·ç¯é›†æˆï¼šç²¾ç¡®éªŒè¯è¿ç« æ˜¯å¦æˆç«‹
# âœ… é”™è¯¯å¤„ç†ï¼šå®Œæ•´çš„è¶…æ—¶ã€é‡è¯•ã€å¼‚å¸¸å¤„ç†æœºåˆ¶
# âœ… æ•°æ®å®Œæ•´æ€§ï¼šä»»åŠ¡ä¸ç»“æœçš„å®Œæ•´å…³è”è¿½è¸ª
#
# ğŸ® æ‚¨åŒå­¦åªéœ€è¦å®ç°ï¼š
# 1. æ¥æ”¶æ‚¨çš„åˆ†æè¯·æ±‚ï¼ˆPOST /analyze-videoï¼‰
# 2. å°†ç»“æœå‘é€åˆ°æ‚¨çš„å›è°ƒåœ°å€ï¼ˆPOST /api/violation-detection/ai-callbackï¼‰
# 3. åˆ†æå®Œæˆæ—¶é€šçŸ¥æ‚¨ï¼ˆPOST /api/violation-detection/ai-completedï¼‰
#
# å…¶ä»–æ‰€æœ‰é—®é¢˜éƒ½å·²åœ¨æ‚¨çš„åç«¯ç³»ç»Ÿä¸­è§£å†³ï¼