### 直行绿灯和转弯绿灯测试用例
###############################################
# 新增：直行绿灯和转弯绿灯区分测试
###############################################

###############################################
# 完整信号灯状态测试：直行和转弯独立控制
###############################################

### 1. 测试转弯红灯时转弯（应该构成违章）
POST http://localhost:8081/api/violation-detection/simulate-light
Content-Type: application/x-www-form-urlencoded

intersectionId=1&lightState=TURN_RED&duration=30

###
POST http://localhost:8081/api/violation-detection/detect-frame
Content-Type: application/json

{
  "intersectionId": 1,
  "plateNumber": "转弯红灯001",
  "violationType": "违法转弯",
  "imageUrl": "http://localhost:9000/traffic-violations/turn_red_violation.jpg",
  "confidence": 0.95,
  "cameraId": "turn-red-cam",
  "description": "转弯红灯时转弯（应该构成违章）"
}

### 2. 测试转弯黄灯时转弯（应该构成违章）
POST http://localhost:8081/api/violation-detection/simulate-light
Content-Type: application/x-www-form-urlencoded

intersectionId=1&lightState=TURN_YELLOW&duration=5

###
POST http://localhost:8081/api/violation-detection/detect-frame
Content-Type: application/json

{
  "intersectionId": 1,
  "plateNumber": "转弯黄灯001",
  "violationType": "违法转弯",
  "imageUrl": "http://localhost:9000/traffic-violations/turn_yellow_violation.jpg",
  "confidence": 0.92,
  "cameraId": "turn-yellow-cam",
  "description": "转弯黄灯时转弯（应该构成违章）"
}

### 3. 设置路口为直行绿灯状态
POST http://localhost:8081/api/violation-detection/simulate-light
Content-Type: application/x-www-form-urlencoded

intersectionId=1&lightState=STRAIGHT_GREEN&duration=30

### 2. 直行绿灯时转弯 - 应该构成违章
POST http://localhost:8081/api/violation-detection/detect-frame
Content-Type: application/json

{
  "intersectionId": 1,
  "plateNumber": "测试直行001",
  "violationType": "违法转弯",
  "imageUrl": "http://localhost:9000/traffic-violations/straight_green_turn.jpg",
  "confidence": 0.95,
  "cameraId": "turn-cam",
  "description": "直行绿灯时转弯（应该构成违章）"
}

### 3. 验证当前红绿灯状态
GET http://localhost:8081/api/violation-detection/light-state/1

###

### 4. 设置路口为转弯绿灯状态
POST http://localhost:8081/api/violation-detection/simulate-light
Content-Type: application/x-www-form-urlencoded

intersectionId=1&lightState=TURN_GREEN&duration=30

### 5. 转弯绿灯时转弯 - 不应该构成违章
POST http://localhost:8081/api/violation-detection/detect-frame
Content-Type: application/json

{
  "intersectionId": 1,
  "plateNumber": "测试转弯001",
  "violationType": "违法转弯",
  "imageUrl": "http://localhost:9000/traffic-violations/turn_green_turn.jpg",
  "confidence": 0.95,
  "cameraId": "turn-cam",
  "description": "转弯绿灯时转弯（不应该构成违章）"
}

### 6. 验证当前红绿灯状态
GET http://localhost:8081/api/violation-detection/light-state/1

###

### 7. 批量测试不同绿灯状态下的转弯行为
POST http://localhost:8081/api/violation-detection/detect-batch
Content-Type: application/json

{
  "violations": [
    {
      "intersectionId": 2,
      "plateNumber": "批量测试001",
      "violationType": "违法转弯",
      "imageUrl": "http://localhost:9000/traffic-violations/batch_turn_1.jpg",
      "confidence": 0.90,
      "cameraId": "cam-batch-1",
      "description": "批量测试转弯违规-1"
    },
    {
      "intersectionId": 2,
      "plateNumber": "批量测试002",
      "violationType": "违法转弯", 
      "imageUrl": "http://localhost:9000/traffic-violations/batch_turn_2.jpg",
      "confidence": 0.88,
      "cameraId": "cam-batch-2",
      "description": "批量测试转弯违规-2"
    }
  ]
}

###############################################
# 完整信号周期测试
###############################################

### 8. 测试红灯时转弯（应该构成违章）
POST http://localhost:8081/api/violation-detection/simulate-light
Content-Type: application/x-www-form-urlencoded

intersectionId=3&lightState=RED&duration=30

###
POST http://localhost:8081/api/violation-detection/detect-frame
Content-Type: application/json

{
  "intersectionId": 3,
  "plateNumber": "红灯转弯001",
  "violationType": "违法转弯",
  "imageUrl": "http://localhost:9000/traffic-violations/red_turn.jpg",
  "confidence": 0.92,
  "cameraId": "red-turn-cam",
  "description": "红灯时转弯（应该构成违章）"
}

### 9. 测试黄灯时转弯（应该构成违章）
POST http://localhost:8081/api/violation-detection/simulate-light
Content-Type: application/x-www-form-urlencoded

intersectionId=3&lightState=YELLOW&duration=5

###
POST http://localhost:8081/api/violation-detection/detect-frame
Content-Type: application/json

{
  "intersectionId": 3,
  "plateNumber": "黄灯转弯001",
  "violationType": "违法转弯",
  "imageUrl": "http://localhost:9000/traffic-violations/yellow_turn.jpg",
  "confidence": 0.89,
  "cameraId": "yellow-turn-cam",
  "description": "黄灯时转弯（应该构成违章）"
}

### 10. 查询所有违章记录，验证处理结果
GET http://localhost:8081/api/violations?page=1&size=20

###############################################
# 信号灯配置查询
###############################################

### 11. 查询所有路口的信号灯配置（应该包含新的直行绿灯和转弯绿灯时长）
GET http://localhost:8081/api/signal-configs

### 12. 查询单个路口配置
GET http://localhost:8081/api/signal-configs/1

###############################################
# 边界情况测试
###############################################

### 13. 测试闯红灯（不受绿灯类型影响，红灯时才构成违章）
POST http://localhost:8081/api/violation-detection/detect-frame
Content-Type: application/json

{
  "intersectionId": 1,
  "plateNumber": "闯红灯测试001",
  "violationType": "闯红灯",
  "imageUrl": "http://localhost:9000/traffic-violations/red_light_test.jpg",
  "confidence": 0.97,
  "cameraId": "red-light-cam",
  "description": "闯红灯行为测试"
}

### 14. 测试逆行和跨实线（不受红绿灯状态影响）
POST http://localhost:8081/api/violation-detection/detect-frame
Content-Type: application/json

{
  "intersectionId": 1,
  "plateNumber": "逆行测试001",
  "violationType": "逆行",
  "imageUrl": "http://localhost:9000/traffic-violations/wrong_way_test.jpg",
  "confidence": 0.94,
  "cameraId": "wrong-way-cam",
  "description": "逆行行为测试（不受红绿灯影响）"
}